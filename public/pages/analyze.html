<!-- Made an Edit -->

<div class='page-header page-header-with-buttons'>
    <h1>
        <i class='fa fa-bar-chart-o'></i>
        <span>Analyze</span>
    </h1>
</div>

<div class="container-fluid">
<accordion>
<accordion-group heading="Quick Hits - Last 30 days" >
    <div class="container-fluid">
	<div class="row">
		<div class="col-sm-2 dashboard-panel">
            <div class="panel-heading">
                <h3 class="panel-title">Average Messages Per Day</h3>
            </div>
            <div class="panel panel-default">
                <div class="panel-body">
                    <div ng-switch="!!topResults.avgMsgPerDay ? topResults.avgMsgPerDay : 0">
                        <h1>
                            <div ng-switch-when="0"><i class="fa fa-cog fa-spin"></i></div>
                            <div ng-switch-default>{{topResults.avgMsgPerDay}}
                            </div>
                        </h1>
                    </div>
                </div>
            </div>
        </div>
	
	<div class="col-sm-2 dashboard-panel">
            <div class="panel-heading">
                <h3 class="panel-title">Average Messages Per Hour</h3>
            </div>
            <div class="panel panel-default">
                <div class="panel-body">
                    <div ng-switch="!!topResults.avgMsgPerHour ? topResults.avgMsgPerHour : 0">
                        <h1>
                            <div ng-switch-when="0"><i class="fa fa-cog fa-spin"></i></div>
                            <div ng-switch-default>{{topResults.avgMsgPerHour}}
                            </div>
                        </h1>
                    </div>
                </div>
            </div>
        </div>
<div class="col-sm-2 dashboard-panel">
            <div class="panel-heading">
                <h3 class="panel-title">Number of Channels</h3>
            </div>
            <div class="panel panel-default">
                <div class="panel-body">
                    <div ng-switch="!!topResults.distCountChannels ? topResults.distCountChannels : 0">
                        <h1>
                            <div ng-switch-when="0"><i class="fa fa-cog fa-spin"></i></div>
                            <div ng-switch-default>{{topResults.distCountChannels}}
                            </div>
                        </h1>
                    </div>
                </div>
            </div>
        </div>

	<div class="col-sm-2 dashboard-panel">
            <div class="panel-heading">
                <h3 class="panel-title">Distinct Count of Devices</h3>
            </div>
            <div class="panel panel-default">
                <div class="panel-body">
                    <div ng-switch="!!devices ? devices.length : 0">
                        <h1>
                            <div ng-switch-when="0"><i class="fa fa-cog fa-spin"></i></div>
                            <div ng-switch-default>{{topResults.distCountDevice}}
                            </div>
                        </h1>
                    </div>
                </div>
            </div>
        </div>
<div class="col-sm-2 dashboard-panel">
            <div class="panel-heading">
                <h3 class="panel-title">Distinct Devices sent from</h3>
            </div>
            <div class="panel panel-default">
                <div class="panel-body">
                    <div ng-switch="!!devices ? devices.length : 0">
                        <h1>
                            <div ng-switch-when="0"><i class="fa fa-cog fa-spin"></i></div>
                            <div ng-switch-default>{{topResults.distCountFromDevice}}
                            </div>
                        </h1>
                    </div>
                </div>
            </div>
        </div>
<div class="col-sm-2 dashboard-panel">
            <div class="panel-heading">
                <h3 class="panel-title">Distinct Devices sent to</h3>
            </div>
            <div class="panel panel-default">
                <div class="panel-body">
                    <div ng-switch="!!devices ? devices.length : 0">
                        <h1>
                            <div ng-switch-when="0"><i class="fa fa-cog fa-spin"></i></div>
                            <div ng-switch-default>{{topResults.distCountToDevice}}
                            </div>
                        </h1>
                    </div>
                </div>
            </div>
        </div>
	</div>
        <div class="row">
		<div class="col-sm-4 dashboard-panel">
                <div class="panel-heading">
                    <h3 class="panel-title">Top Event Codes</h3>
                </div>
                <div class="panel panel-default">
                    <a href="">
                        <div class="panel-body">
                            <div ng-switch="!!topResults.eventCodes ? 1 : 0">
                               <div ng-switch-when="0"><h1><i class="fa fa-cog fa-spin"></i></h1></div>
                                <div ng-switch-default>
                                    <div nvd3-pie-chart  data="topResults.eventCodes" height="300">
                                        </div>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="col-sm-4 dashboard-panel">
                <div class="panel-heading">
                    <h3 class="panel-title">Top Devices Sending</h3>
                </div>
                <div class="panel panel-default">
                    <a href="">
                        <div class="panel-body">
                            <div ng-switch="!!topResults.fromUuid ? 1 : 0">
                               <div ng-switch-when="0"><h1><i class="fa fa-cog fa-spin"></i></h1></div>
                                <div ng-switch-default>
                                    <div nvd3-pie-chart  data="topResults.fromUuid" height="300">
					</div>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="col-sm-4 dashboard-panel">
                <div class="panel-heading">
                    <h3 class="panel-title">Top Devices Receiving</h3>
                </div>
                <div class="panel panel-default">
                    <a href="">
                        <div class="panel-body">
                            <div ng-switch="!!topResults.toUuid ? 1 : 0">
                                <div ng-switch-when="0"><h1><i class="fa fa-cog fa-spin"></i></h1></div>
                                <div ng-switch-default>
                                    <div nvd3-pie-chart data="topResults.toUuid" height="300"></div>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
    <!-- Endof Container Fluid-->
</accordion-group>
<!-- Maybe later
<accordion-group heading="Time Ranges">
    <div class="row">
        <div class="col-md-10">
            <h2>Count of EventCodes over time</h2>
        </div>
    </div>
</accordion-group> -->
<accordion-group heading="Freeform Search">
    <div class="container-fluid">
        <div class="row">
            <div class="input-group">
                <form class="form-inline col-md-12">
                    <div class="form-group col-md-8">
                        <input type="text" class="form-control" ng-model="forms.FF_searchText"
                               placeholder="Search" autofocus/>
                    </div>
                    <div class="form-group col-md-2">
                        <select class="form-control" ng-model="forms.FF_eventCode">
                            <option value="">All Event Codes</option>
                            <option ng-repeat="event in events" value="{{event.code}}">{{event.name}}
                            </option>
                        </select>

                    </div>
                    <div class="form-group col-md-2">
                      <span class="input-group-btn">
                          <button class="btn btn-default" type="button" ng-click="search()">
                              <span class="glyphicon glyphicon-search"> Find</span>
                          </button>
                      </span>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="panel panel-info" ng-show="results">
        <!-- Default panel contents -->
        <div class="panel-heading">Results
            <p class="pull-right"> hits: {{ results.hits.total }}</p>
        </div>
        <div class="panel-body">
		<table class="table table-striped table-condensed table-hover">
			<thead><tr><th ng-repeat="header in freeform_results_ngTable.headers" class="{{header.name}}" custom-sort order="header.name" sort="sort">
			<a ng-click="sort_by(order)" style="color: #555;"><i ng-class="selectedCls(order)">{{header.name}}</i></a></th></tr></thead>
			<tfoot>
	                <td colspan="{{freeform_results_ngTable.headers.length}}">
        	            <div >
	                        <ul class="pagination">
                        	    <li ng-class="{disabled: currentPage == 0}">
                	                <a href="/analyze#" ng-click="prevPage()">Â« Prev</a>
        	                    </li>
	
	                            <li ng-repeat="n in range(freeform_results_ngTable.pagedItems.length, 0, (results.hits.total / ff.maxSize -1 ), 1)"
                        	        ng-class="{active: n == currentPage}" >
        	                        <span ng-bind="n + 1">1</span>
	                            </li>

	                            <li ng-class="{disabled: (currentPage) == freeform_results_ngTable.pagedItems.length - 1}">
        	                        <a href="/analyze#" ng-click="nextPage()">Next Â»</a>
	                            </li>
                        	</ul>
                	    </div>
	                </td>
        	        </tfoot>
			<tbody>
	                <tr ng-repeat="item in freeform_results_ngTable.pagedItems[currentPage] | orderBy:sort.sortingOrder:sort.reverse">
        	             <!--<td ng-repeat="val in item" ng-bind-html-unsafe="item._source[freeform_results_ngTable.headers[$index].name]"></td>-->
				<td ng-repeat="header in freeform_results_ngTable.headers">{{ item._source[header.name] | freeFormDisplayText  }}</td>
                	</tr>
		        </tbody>
		</table>
        </div>
    </div>

</accordion-group>
<accordion-group heading="Explore">
    <div class="container-fluid">
        <div class="row">
            <form novalidate>
                <div class="col-md-4 dashboard-panel">
                    <div class="panel-heading">
                        <h3 class="panel-title">Device Selection</h3>
                        <span><kbd>ctrl+click</kbd> for multiple</span>
                    </div>
                    <div class="panel ">
                        <a href="">
                            <div class="panel-body">
                                <select class="form-control" size=10 style="height:100%" multiple
                                        ng-model="forms.EX_graphDevices">
                                    <option value="all" selected="selected">All Devices</option>
                                    <option ng-repeat="cb_device in devices" value="{{cb_device.uuid}}">
                                        {{cb_device.name}}
                                    </option>
                                </select>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="col-md-8 dashboard-panel">
                    <div class="row">
                        <div class="col-md-4 dashboard-panel">
                            <div class="panel-heading">
                                <h3 class="panel-title">Options</h3>
                            </div>
                            <div class="panel">
                                <div class="form-group">
                                    <label for="eventCode"> Event Code: </label> <select multiple size=5
                                                                                         class="form-control"
                                                                                         ng-model="forms.EX_eventCode">
                                    <option value="all">All Event Codes</option>
                                    <option ng-repeat="event in events" value="{{event.code}}">
                                        {{event.name}}
                                    </option>
                                </select>
                                </div>
                                <div class="form-group">
                                    <label for="starting"> Starting: </label><select
                                        class="form-control" ng-model="forms.EX_starting">
                                    <option ng-repeat="df in ESdateFormats" value="{{df.value}}"
                                    >{{df.text}}</option>
                                </select>
                                    <label for="ending"> Ending: </label> <select class="form-control"
                                                                                  ng-model="forms.EX_ending">
                                    <option ng-repeat="df in ESdateFormats" value="{{df.value}}"
                                    >{{df.text}}</option>
                                </select>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-8 dashboard-panel">
                            <div class="panel-heading">
                                <h3 class="panel-title">Summary Results</h3>
                            </div>
                            <div class="panel">
                                <table class="table table-hover">
                                    <tr>
                                        <td>Different Event Codes:</td>
                                        <td>{{leg.dcEC}}</td>
                                    </tr>
                                    <tr>
                                        <td>Total Events Returned:</td>
                                        <td>{{leg.total}}</td>
                                    </tr>
				    <tr>
					<td>Different UUIDs:</td>
					<td>{{leg.dcUUIDs}}</td>
				    </tr>
                                </table>
			<div class="form-group col-md-2 text-center">
				<span class="input-group-btn">
                                          <button class="btn btn-default" type="button" ng-click="loadExploreGraph()">
                                      <span class="glyphicon glyphicon-search"> Find</span>
                                  </button>
                                      </span>
                            </div>
			  </div>
                        </div>
                    </div>
            </form>
        </div>
        <!-- end Choices Div Row -->
        <div class="row">
	<div class="col-sm-8 dashboard-panel">
            <div class="panel-heading">
                <h3 class="panel-title">Event Counts over Time</h3>
            </div>
            <div class="panel panel-default">
                    <div class="panel-body">
                        <div ng-switch="!!leg ? 1 : 0">
                            <div ng-switch-when="0"><h1><i class="fa fa-cog fa-spin"></i></h1></div>
                            <div ng-switch-default>
                                <div nvd3-line-chart show-legend="True" axis-x-label="Hour" axis-x-type="date"
                                     axis-x-format="%-m/%-d %-H:%-M" data="leg.uuid_counts" height="400" ></div>
                            </div>
                        </div>
                    </div>
            </div>
        </div>

        </div>
    </div>
</accordion-group>
</accordion>
</div>
