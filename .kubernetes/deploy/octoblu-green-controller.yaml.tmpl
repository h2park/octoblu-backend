id: octoblu-green-controller
kind: ReplicationController
apiVersion: v1beta1
labels:
  name: octoblu-green
  version: "$SHORT_COMMIT"
desiredState:
  replicas: 6
  replicaSelector:
    name: octoblu-green
    version: "$SHORT_COMMIT"
  podTemplate:
    labels:
      name: octoblu-green
      app: octoblu-green
      version: "$SHORT_COMMIT"
    desiredState:
      manifest:
        version: v1beta1
        id: octoblu-green
        containers:
          - name: octoblu-green
            image: octoblu/octoblu:$SHORT_COMMIT
            ports:
              - containerPort: 80
            env:
              - name: OCTOBLU_PORT
                value: 80
              - name: NODE_ENV
                value: "production"
              - name: TEXT_CRYPT_KEY
                value: $TEXT_CRYPT_KEY
              - name: TEXT_CRYPT_NONCE
                value: $TEXT_CRYPT_NONCE
              - name: AIRBRAKE_KEY
                value: $AIRBRAKE_KEY
              - name: INVITATION_REQUIRED
                value: "true"
              - name: ELASTIC_SEARCH_URI
                value: $ELASTIC_SEARCH_URI
              - name: USE_APP_DYNAMICS
                value: "false"
              - name: APP_DYNAMICS_KEY
                value: $APP_DYNAMICS_KEY
              - name: APP_DYNAMICS_TIER_NAME
                value: nodejs
              - name: APP_DYNAMICS_HOST_NAME
                value: octoblu.saas.appdynamics.com
              - name: APP_DYNAMICS_ACCOUNT_NAME
                value: octoblu
              - name: APP_DYNAMICS_APPLICATION_NAME
                value: $APP_DYNAMICS_APPLICATION_NAME
              - name: APP_DYNAMICS_PORT
                value: 80
              - name: OCTOBLU_UUID
                value: $OCTOBLU_UUID
              - name: OCTOBLU_TOKEN
                value: $OCTOBLU_TOKEN
              - name: REDIS_URL
                value: redis://app-octoblu-com.csy8op.0001.usw2.cache.amazonaws.com
