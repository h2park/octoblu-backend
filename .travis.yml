sudo: false
language: node_js
node_js:
- '0.10'
services:
- mongodb
cache:
  bundler: true
  directories:
  - node_modules
notifications:
  slack:
    secure: j8t7GC1MCh75KcJiUh+Wq8AVGrESS9mZG9EnHSHWSIHr1eGHbNYn9GWR2+/vv6M1Te+TRTCbVU38Z4/VfZf4zYOi7HoY8z9XT97h90+ArEc68qQnDpZyfSsI4n7mYLPWMZtLz41ryZGYZ2ISTLHR2gbJX8kxyTXCWrIAxtG8uT8=
before_script:
- if [ ${TRAVIS_BRANCH} == master ]; then export NODE_ENV=production; else export
  NODE_ENV=staging; fi
- cp .npmrc ~/.npmrc
- npm rebuild bcrypt
- node_modules/.bin/gulp
- export NODE_ENV=test
deploy:
- provider: s3
  access_key_id: AWS_ACCESS_KEY_ID
  secret_access_key: &1
    secure: QU1Uag3phgdGJIsqI3LhSxoNd7wA7BsK55U3rbn2jxDV0L6zAPeMuMMn0nGIWKyS04EpQqBimD+LDw5IqUSAZklbB3kYrJUb1/IujN7p82DuQVl24QerU+xbOxZzJdNOcVOX5dcAEQrRJIV6UOO9nIpDFlOdLYNtr51YUNTsJLg=
  local_dir: dpl_cd_upload
  skip_cleanup: true
  bucket: octoblu-deploy
  on:
    branch: master
